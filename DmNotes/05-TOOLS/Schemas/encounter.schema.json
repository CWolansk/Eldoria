{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://eldoria-campaign.com/schemas/encounter.schema.json",
  "title": "Eldoria D&D 5e Encounter",
  "type": "object",
  "required": ["title", "type", "kingdom", "partyLevel", "environment", "readAloud", "approaches"],
  "properties": {
    "title": {"type": "string"},
    "type": {
      "type": "string", 
      "enum": ["combat", "social", "exploration", "puzzle", "mixed"],
      "description": "Primary encounter type"
    },
    "kingdom": {
      "type": "string",
      "enum": ["Crestfall", "Silverleaf Lands", "Ironpeak Mountain", "Orcish Wastes", "Neutral Territory"],
      "description": "Which kingdom or region this encounter occurs in"
    },
    "partyLevel": {"type": "integer", "minimum": 1, "maximum": 20},
    "partySize": {"type": "integer", "minimum": 1, "maximum": 6, "default": 5},
    "environment": {"type": "string"},
    "tags": {"type": "array", "items": {"type": "string"}},
    "readAloud": {"type": "string", "description": "2-6 sentences, second-person, sensory details"},
    "hook": {"type": "string", "description": "Why the party encounters this situation"},
    "approaches": {
      "type": "array",
      "description": "Multiple ways to handle the encounter",
      "items": {
        "type": "object",
        "required": ["method", "description"],
        "properties": {
          "method": {"type": "string", "enum": ["combat", "social", "stealth", "skill", "magic", "creative"]},
          "description": {"type": "string"},
          "primarySkill": {"type": "string"},
          "dc": {"type": "integer", "enum": [10, 12, 14, 15, 16, 18, 20]},
          "success": {"type": "string"},
          "failure": {"type": "string"},
          "heroPointOpportunity": {"type": "boolean", "default": false}
        }
      }
    },
    "creatures": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["name", "source"],
        "properties": {
          "name": {"type": "string"},
          "count": {"type": "integer", "minimum": 1, "default": 1},
          "source": {"type": "string", "description": "MM p. xx or Bestiary.csv"},
          "notes": {"type": "string"},
          "reinforcementTrigger": {"type": "string"},
          "morale": {"type": "string", "description": "When they flee, surrender, or negotiate"}
        }
      }
    },
    "npcs": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["name", "role"],
        "properties": {
          "name": {"type": "string"},
          "role": {"type": "string"},
          "motivation": {"type": "string"},
          "attitude": {"type": "string", "enum": ["friendly", "neutral", "hostile", "varies"]},
          "guildAffiliation": {"type": "string"},
          "racialBias": {"type": "string", "description": "How they treat JP or other party members"}
        }
      }
    },
    "playerSpotlights": {
      "type": "array",
      "description": "Opportunities for specific party members to shine",
      "items": {
        "type": "object",
        "properties": {
          "character": {"type": "string", "enum": ["Julie", "Liz", "Claire", "JP", "Justin", "Any"]},
          "opportunity": {"type": "string"},
          "mechanic": {"type": "string"}
        }
      }
    },
    "customRules": {
      "type": "array",
      "description": "Campaign-specific rule applications",
      "items": {
        "type": "object",
        "properties": {
          "rule": {"type": "string", "enum": ["Hero Point", "I Know a Guy", "Spell Scroll Use", "Guild Obligation", "Magic Item Hijinks"]},
          "application": {"type": "string"}
        }
      }
    },
    "treasure": {
      "type": "object",
      "properties": {
        "coins": {"type": "string"},
        "items": {"type": "array", "items": {"type": "string"}},
        "magicItems": {"type": "array", "items": {"type": "string"}},
        "information": {"type": "string"},
        "connections": {"type": "string", "description": "NPCs, guilds, or organizations gained"}
      }
    },
    "consequences": {
      "type": "object",
      "required": ["immediate", "longTerm"],
      "properties": {
        "immediate": {"type": "string", "description": "Results visible in this session"},
        "longTerm": {"type": "string", "description": "Effects on future sessions, politics, relationships"},
        "guildStanding": {"type": "string", "description": "How this affects Adventurers or Merchants Guild reputation"},
        "kingdomRelations": {"type": "string", "description": "Political implications"},
        "artifactQuest": {"type": "string", "description": "How this advances or complicates the main plot"}
      }
    },
    "scaling": {
      "type": "object",
      "properties": {
        "weaker": {"type": "string", "description": "Adjustments for lower-level party"},
        "stronger": {"type": "string", "description": "Adjustments for higher-level party"},
        "alternative": {"type": "string", "description": "Different approach for variety"}
      }
    },
    "connections": {
      "type": "object",
      "properties": {
        "previousSessions": {"type": "array", "items": {"type": "string"}},
        "futureHooks": {"type": "array", "items": {"type": "string"}},
        "npcRelationships": {"type": "array", "items": {"type": "string"}},
        "locationDetails": {"type": "string"}
      }
    }
  }
}
